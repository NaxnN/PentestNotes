## convert Kali Linux to a router for Windows to use vpn
```shell
# router side
# Enable IP Forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# Do the forwarding
iptables -A FORWARD -i tun0 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i eth0 -o tun0 -j ACCEPT

# Rewrite the ip address of workstation, add NAT
iptables -t nat -A POSTROUTING -s <workstation_ip>/24 -o tun0 -j MASQUERADE
```

```powershell
# workstation side
# Windows 
route add <target_ip_range> mask <target_ip_netmask> <Kali_IP>

# Linux
ip route add <target_ip_range>/<24> via <Kali_IP>
```

## redirect port
```shell
# redirect incoming traffic from  port 81 to port 82
iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 81 -j REDIRECT --to-port 82

# redirect outcoming traffic from port 85 to port 86
iptables -t nat -A OUTPUT -p tcp --dport 85 -j DNAT --to-destination :86

# reset iptables
iptables -F
reboot
```