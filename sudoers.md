## sudoer file
```
users hosts=(user:group) commands
<username>  ALL=NOPASSWD: ALL
```
## env variable
* testuser ALL=NOPASSWD: /tmp/a.sh
1. sudo: sorry, you are not allowed to set the following environment variables: PATH
<!-- * reason: `Defaults        secure_path=...` in the sudoers file -->
```bash
# with Defaults secure_path=...
sudo -l:

Matching Defaults entries for m4lwhere on previse:
   
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User m4lwhere may run the following commands on previse:
    (root) /opt/scripts/access_backup.sh
```
```bash
# without Defaults secure_path=...
sudo -l:

User m4lwhere may run the following commands on previse:
    (root) /opt/scripts/access_backup.sh
```

2. `testuser ALL=(root) SETENV:NOPASSWD: /usr/bin/python3 /opt/development/test_module.py ` (SETENV)

# Defaults listpw=always
```log
require password for a user even with " ... NOPASSWD ...   "

Finally, you might consider adding Defaults listpw=always to require a password before the command sudo -l yields its usual summary of sudoer's settings and assigned user privileges. It's a final bit of security that sudoers can give you by manipulating passwords. When you are done, quit the text editor as you normally would.
```

## env variable2
`env_keep += xxx1` : be able to set env variable: xxx1

## path traversal
```shell
testuser ALL=(root) SETENV:NOPASSWD: /usr/bin/python3 /opt/development/*.py

exploit:
/usr/bin/python3 /opt/development/../../../tmp/exploit.py
```


## weak permission in user directory
```
sudo -l
/usr/bin/python3 /home/cyber/run.py(owned by root, 700)

exploit: create a new run.py in user directory
```

## relative path
```python
# sudo -l
# /usr/bin/python3 /opt/test.py
...
arg_list = ['./full-checkup.sh']
print(run_command(arg_list))
# the ./ path is on the cwd that the command is executed
```