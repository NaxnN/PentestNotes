### search file 
powershell:
```powershell
Get-ChildItem -Filter *.txt -Recurse
Get-ChildItem  -R -include *test*
```

### history file location
`$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\`



### Disable Windows Defender (Need high privilege)

#### check Windows AV:
```powershell
Get-MpPreference |Select-Object DisableRealtimeMonitoring
```
#### disable Windows AV:
```powershell
Set-MpPreference -DisableRealtimeMonitoring $true
```

### disable firewall
```cmd
netsh advfirewall set allprofiles state on/off
```



### hosts file location
`C:\Windows\System32\drivers\etc\hosts`


### account having administrative privileges
```powershell
net localgroup administrators
```

### sudo -l
`whoami /priv`

### windows webserver file folder
`/inetpub/wwwroot`

### psexec
impacket-psexec test.local/john:password123@10.10.10.1

```powershell 
 .\PsExec.exe -s -i powershell.exe # local admin to nt authority\system
```
### multiline string
```powershell
# reverse $variable inside
$a=@'
...
'@
```
```powershell
# do not reverse $variable inside
$a=@"
...
"@
```

## powershell zip and unzip file
```powershell
Compress-Archive -Path <SourcePathofResource> -DestinationPath <DestinationZipFilePath>
Expand-Archive -Path <SourcePathofZipFile> -DestinationPath <DestinationPath>
```

## host discovery
```cmd
for /L %z in (1,1,254) do @ping 192.168.0.%z -w 10 -n 1 | findstr "Reply"
```

## powershell tee
```powershell
Get-Process | Tee-Object -FilePath "C:\Test1\testfile2.txt"
```

## powershell hash
```powershell
Get-FileHash <filepath> -Algorithm MD5
```

## powershell grep
```powershell
Select-String -Path "Users\*.csv" -Pattern "Joe"
ls |findstr "csv"
```