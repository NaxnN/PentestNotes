### search file 
powershell:
```powershell
Get-ChildItem -Filter *.txt -Recurse
```

### history file location
`$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\`



### Disable Windows Defender (Need high privilege)

#### check Windows AV:
```powershell
Get-MpPreference |Select-Object DisableRealtimeMonitoring
```
#### disable Windows AV:
```powershell
Set-MpPreference -DisableRealtimeMonitoring $true
```

### disable firewall
```cmd
netsh advfirewall set allprofiles state on
```

### runas
```powershell   
runas /user:administrator cmd
```

### read file permission
```powershell
get-acl file
```

### change file permissions
```powershell
$acl = Get-Acl filename
$AccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule("username_here","FullControl","Allow")
$acl.SetAccessRule($AccessRule)
(Get-Item filenamese).SetAccessControl($acl)
```

### hosts file location
`C:\Windows\System32\drivers\etc\hosts`


### account having administrative privileges
```powershell
net localgroup administrators
```

### sudo -l
`whoami /priv`

### windows webserver file folder
`/inetpub/wwwroot`

### psexec
impacket-psexec test.local/john:password123@10.10.10.1

### multiline string
```powershell
# reverse $variable inside
$a=@'
...
'@
```
```powershell
# do not reverse $variable inside
$a=@"
...
"@
```

## powershell zip and unzip file
```powershell
Compress-Archive -Path <SourcePathofResource> -DestinationPath <DestinationZipFilePath>
Expand-Archive -Path <SourcePathofZipFile> -DestinationPath <DestinationPath>
```

## host discovery
```cmd
for /L %z in (1,1,254) do @ping 192.168.0.%z -w 10 -n 1 | findstr "Reply"
```