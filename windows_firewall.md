## find firewall ports
```powershell
netsh advfirewall firewall show rule name=all | select-string  <localport> # -context 3,3   # 3 lines before and after 'localport'
netsh advfirewall firewall show rule name=all | select-string  <remoteport> # -context 3,3
netsh advfirewall firewall show rule name=all | select-string  allow  -context 5,5
```

## disable firewall
```cmd
netsh advfirewall set allprofiles state on/off
```

### add/delete rule
```powershell
netsh advfirewall firewall add rule name="rule1" protocol=TCP dir=in localip=192.168.50.64 localport=2222 action=allow
netsh advfirewall firewall delete rule name="rule1"
```


## port forward
```powershell
netsh interface portproxy add v4tov4 listenport=2222 listenaddress=192.168.50.64 connectport=22 connectaddress=10.4.50.215 # add
netsh interface portproxy del v4tov4 listenport=2222 listenaddress=192.168.50.64 # delete
```